/*
 * To change this template, choose Tools | Templates
 * and open the template in the editor.
 */

package chatter;

/**
 *
 * @author maggiecelentano
 */
import java.io.*;

import java.net.*;

public class ServerThread extends Thread
{
   //the Server that spawned us
   private Server server;
   //the scoket connected to our client
   private Socket socket;

    // Constructor.

   public ServerThread(Server server, Socket socket)
   {

      // Save the parameters

      this.server = server;

      this.socket = socket;


      // Start up the thread
      start();
   }

   public void run()
   {
      try
      {

         // Create a DataInputStream for communication; the client

         // is using a DataOutputStream to write to us

         DataInputStream din = new DataInputStream(socket.getInputStream());


         // Over and over, forever ...

         while (true)
         {

            // ... read the next message ...

            String message = din.readUTF();


            // ... tell the world ...
            System.out.println("Sending "+message);


            // ... and have the server send it to all clients

            server.sendToAll(message);

          }

      }
      catch(EOFException ie)
      {

         // This doesn't need an error message

      }
      catch(IOException ie)
      {

        // This does; tell the world!

        ie.printStackTrace();

      }
      finally
      {

       // The connection is closed for one reason or another,

       // so have the server dealing with it

       server.removeConnection(socket);
      }
    }//end run method
}//end ServerThread class





